<?php
core::import('core/model');
class {{table}} extends model {

	{{comment}}//Это список полей, используемых в self::load и self::loadById, если второй параметр не указан{{/comment}}
	protected $fields='{{fields}}';

	function __construct($db='db') {
		parent::__construct('{{table}}',$db);
	}

	{{comment}}//Должен возвращать массив правил валидации.
	//Используется в том случае, если в self::validate и self::save правила не указаны явно{{/comment}}
	protected function validateRule() {
		return array(
			{{validateRule}}
		);
	}

	{{comment}}//Выполняется после валидации, но до выполнения SQL-запроса.
	//$id - первичный ключ, если есть, $fields - список полей, учавствующих в запросе INSERT или UPDATE.
	//Если вернёт FALSE, то SQL-запрос выполнен не будет (установите в controller::$error сообщение об ошибке).{{/comment}}
	protected function beforeInsertUpdate($id,$fields) {
		return true;
	}

	{{comment}}//Выполняется после выполнения SQL-запроса INSERT.
	//$id содержит первичный ключ. Возвращаемое значение будет возвращено self::save.{{/comment}}
	protected function afterInsert($id) {
		return true;
	}

	{{comment}}//Выполняется после выполнения SQL-запроса UPDATE.
	//$id содержит первичный ключ. Возвращаемое значение будет возвращено self::save.{{/comment}}
	protected function afterUpdate($id) {
		return true;
	}
	{{comment}}
	/* Вы также можете перегрузить следующие методы:
	- public function set($data)
		Загружает данные для всех полей таблицы.
		Тут можно провести какие-либо манипуляции с получаемыми данными.

	- public function get()
		Возвращает массив данных всех полей таблицы.
		Тут можно подготовить данные для использования вне класса

	- public function &load($where,$fields=null)
		Выполняет SQL-запрос SELECT

	- public function &loadById($id,$fields=null)
		Выполняет загрузку данных по первичному ключу

	- public function validate($validate=null)
		Выполняет валидацию. Вероятно $validate использовать нет необходимости

	- public function save($validate=true,$fields=null,$id=null)
		Выполняет SQL-запрос INSERT или UPDATE, в зависимости от того, есть ли первичный ключ.
		Вероятно никаких параметров перегруженная функция получать не должна

	- public function delete($id=null,$affected=false)
		Выполняет удаление записи по первичному ключу
		Тут можно удалить сопутствующие файлы
	*/
	{{/comment}}
}
?>